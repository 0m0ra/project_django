{% extends 'todo_app/base.html' %}

{% block content %}
<div class="todo-container">
    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
    <div class="add-task-section">
        <form method="post" action="{% url 'todo_app:task_create' %}" id="task-form" class="task-form">
            {% csrf_token %}
            <div class="input-group">
                <input 
                    type="text" 
                    name="title" 
                    class="task-input" 
                    placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É..." 
                    required
                    autofocus
                >
                <input 
                    type="date" 
                    name="due_date" 
                    class="task-date-input" 
                    title="–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"
                >
                <button type="submit" class="add-btn" title="–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É">
                    <span class="plus-icon">+</span>
                </button>
            </div>
        </form>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="stats">
        <div class="stat-item">
            <span class="stat-label">–í—Å–µ–≥–æ –∑–∞–¥–∞—á:</span>
            <span class="stat-value">{{ total_tasks }}</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ:</span>
            <span class="stat-value completed-stat">{{ completed_count }}</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö:</span>
            <span class="stat-value active-stat">{{ active_tasks.count }}</span>
        </div>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á -->
    {% if active_tasks %}
    <div class="tasks-section">
        <h2 class="section-title">–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏</h2>
        <ul class="task-list" id="active-tasks">
            {% for task in active_tasks %}
            <li class="task-item" data-task-id="{{ task.id }}">
                <label class="task-checkbox">
                    <input 
                        type="checkbox" 
                        class="task-checkbox-input" 
                        data-task-id="{{ task.id }}"
                        {% if task.completed %}checked{% endif %}
                    >
                    <span class="checkmark"></span>
                </label>
                <span class="task-title">{{ task.title }}</span>
                {% if task.due_date %}
                    <span class="task-date {% if task.due_date < today %}overdue{% elif task.due_date == today %}today{% endif %}">
                        üìÖ {{ task.due_date|date:"d.m.Y" }}
                    </span>
                {% endif %}
                <button 
                    class="delete-btn" 
                    data-task-id="{{ task.id }}"
                    title="–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É"
                    aria-label="–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É"
                >
                    üóë
                </button>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    <!-- –°–ø–∏—Å–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á -->
    {% if completed_tasks %}
    <div class="tasks-section completed-section">
        <h2 class="section-title">–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏</h2>
        <ul class="task-list completed-list" id="completed-tasks">
            {% for task in completed_tasks %}
            <li class="task-item completed" data-task-id="{{ task.id }}">
                <label class="task-checkbox">
                    <input 
                        type="checkbox" 
                        class="task-checkbox-input" 
                        data-task-id="{{ task.id }}"
                        checked
                    >
                    <span class="checkmark"></span>
                </label>
                <span class="task-title">{{ task.title }}</span>
                {% if task.due_date %}
                    <span class="task-date {% if task.due_date < today %}overdue{% elif task.due_date == today %}today{% endif %}">
                        üìÖ {{ task.due_date|date:"d.m.Y" }}
                    </span>
                {% endif %}
                <button 
                    class="delete-btn" 
                    data-task-id="{{ task.id }}"
                    title="–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É"
                    aria-label="–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É"
                >
                    üóë
                </button>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
    {% if not active_tasks and not completed_tasks %}
    <div class="empty-state">
        <div class="empty-icon">üìù</div>
        <h3>–ù–µ—Ç –∑–∞–¥–∞—á</h3>
        <p>–î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É –≤—ã—à–µ!</p>
    </div>
    {% endif %}
</div>
{% endblock %}

